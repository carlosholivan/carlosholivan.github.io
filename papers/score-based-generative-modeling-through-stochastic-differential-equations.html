<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Carlos Hern&aacute;ndez Oliv&aacute;n</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="author" content="" />

  <!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="favicon.ico">

	<link href="https://fonts.googleapis.com/css?family=Karla:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="../css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="../css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="../css/bootstrap.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="../css/owl.carousel.min.css">
	<link rel="stylesheet" href="../css/owl.theme.default.min.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="../css/magnific-popup.css">

	<link rel="stylesheet" href="../css/style.css">


	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

	</head>
	<body>

	<!-- Google Analytics -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-3CDKKZRCVT"></script>
	<script>
		window.dataLayer = window.dataLayer || [];
		function gtag(){dataLayer.push(arguments);}
		gtag('js', new Date());
		gtag('config', 'G-3CDKKZRCVT');
	</script>

	<nav id="colorlib-main-nav" role="navigation">
		<a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle active"><i></i></a>
		<div class="js-fullheight colorlib-table">
			<div class="colorlib-table-cell js-fullheight">
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<input type="text" class="form-control" id="search" placeholder="Enter any key to search...">
							<button type="submit" class="btn btn-primary"><i class="icon-search3"></i></button>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<ul>
							<li><a href="../index.html">Home</a></li>
							<li><a href="../curriculum.html">CV</a></li>
							<li><a href="../publications.html">Publications</a></li>
							<li><a href="../talks.html">Talks</a></li>
							<li class="active"><a href="../teaching.html">Teaching</a></li>
							<li><a href="../community-service.html">Community Service</a></li>
							<li><a href="../blog.html">Blog</a></li>
							<li><a href="../others.html">Others</a></li>
							<li><a href="../about.html">About</a></li>
							<li><a href="../contact.html">Contact</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</nav>
	
	<div id="colorlib-page">
		<header>
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div class="colorlib-navbar-brand">
							<a class="colorlib-logo" href="../index.html"><span>Ch</span><span>o</span></a>
						</div>
						<a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle"><i></i></a>
					</div>
				</div>
			</div>
		</header>

        <div id="colorlib-blog">
            <div class="container">
                <div class="row text-center">
                    <h2 class="bold">Paper Title</h2>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <div class="blog-entry">
                            <div class="desc">
                                <h1 class="text-center"><strong>Score-Based Generative Modeling through Stochastic Differential Equations</strong></h1>
                                <h3 class="text-center">Yang Song, Jascha Sohl-Dickstein, Diederik P. Kingma, Abhishek Kumar, Stefano Ermon, Ben Poole</h3>
                                <h4 class="text-center">In <em>International Conference on Learning Representations (ICLR)</em>, 2021</h4>
                                <p class="text-center">score-based models, diffusion models</p>
                            
                                <!--Bibtex citation-->
                                <style>
                                    body {
                                        margin: 0 auto; /* Remove default margin */
                                        background-color: #f0f0f0; /* Optional background color */
                                    }
                                    .bibtex-box {
                                        border: 1px solid #ccc;
                                        border-radius: 5px;
                                        padding: 5px; /* Reduced padding */
                                        margin: 20px auto; /* Center horizontally and add vertical margins */
                                        font-family: monospace;
                                        background-color: #f9f9f9;
                                        max-width: 600px; /* Set a maximum width */
                                        max-height: auto;
                                        text-align: left; /* Align text to the left */
                                    }
                                    .title {
                                        margin-bottom: 5px; /* 5px padding below the title */
                                    }
                                </style>
                                <div class="bibtex-box">
                                    <span style="font-size: smaller;" class="title">@article{song2021scorebased,</span><br>
                                    <span style="padding-left: 20px;font-size: smaller;">title={Score-Based Generative Modeling through Stochastic Differential Equations},</span><br>
                                    <span style="padding-left: 20px;font-size: smaller;">author={Yang Song and
										Jascha Sohl{-}Dickstein and
										Diederik P. Kingma and
										Abhishek Kumar and
										Stefano Ermon and
										Ben Poole},</span><br>
                                    <span style="padding-left: 20px;font-size: smaller;">year={2021},</span><br>
                                    <span style="padding-left: 20px;font-size: smaller;">booktitle={9th International Conference on Learning Representations, {ICLR}}</span><br>
                                    <span>}</span>
                                </div>
                                <div class="text-center">
                                    <a href="https://arxiv.org/abs/2011.13456" class="btn btn-primary btn-outline">PDF</a>
                                    <a href="https://yang-song.net/assets/pdf/ICLR2021/score_sde.pdf" class="btn btn-primary btn-outline">Poster</a>
									<a href="https://github.com/yang-song/score_sde" class="btn btn-primary btn-outline"><i class="icon-github"></i> Code</a>
                                    <a href="https://yang-song.net/blog/2021/score/" class="btn btn-primary btn-outline">Blog</a>
                                </div>
                                <div style="padding-left: 20px;">
                                    <p>TL;DR: Define continuous-time stochastic processes instead of discrete steps, enabling better control and flexibility. The reverse SDE is learned using score matching, and this framework can generalize to various types of noise schedules (like the variance-exploding or variance-preserving SDEs).</p>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="article animate-box">
                                        <h2 id="table-of-contents">
                                            Table of Contents
                                        </h2>
                                        <h4 style="padding-left: 20px;">
                                            <a href="#introduction" style="text-decoration: none; color: inherit;">1. Introduction</a>
                                        </h4>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="article animate-box">
                                        <h2 id="introduction">
                                            <a href="#table-of-contents" style="text-decoration: none; color: inherit;">1. Introduction and Background</a>
                                        </h2>
										<h3>1.1. Denoising Score Matching with Langevin Dynamics</h3>
										<p>
											In <a href="generative-modeling-by-estimating-gradients-of-the-data-distribution.html">[Song et al. 2019]</a> we discussed the role of Langevin dynamics in score matching.
											To recap, Langevin dynamics consists of a stochastic differential equation (SDE) that describes the evolution of a particle in a potential field.
											We can use the score function, which is the gradient of the log-density of the data distribution, and apply Langevin dynamics to generate new samples from the score function.
											<br>
											Let's define a perturbation kernel:
											\[ 
												p_\sigma(\mathbf{\hat{x}} \vert \mathbf{x}) := \mathcal{N}(\mathbf{x}; \mathbf{x}, \sigma_i^2 \mathbf{I})
											\]
											where:
											<ul>
												<li>\( \mathbf{x} \) is the data point.</li>
												<li>\( \mathbf{\hat{x}} \) is the noisy observation.</li>
												<li>\( \sigma \) is the noise scale or standard deviation of the noise.</li>
											</ul>
										</p>
                                    </div>
                                </div>
                            </div>
							<div class="row">
                                <div class="col-md-12">
                                    <div class="article animate-box">
                                        <h2 id="introduction">
                                            <a href="#table-of-contents" style="text-decoration: none; color: inherit;">2. Noise Perturbations</a>
                                        </h2>
										<h3>2.1. Noise Perturbations, VP and VE</h3>
										<p>
											Both Score matching with Langevin dynamics (SMLD) and Denoising Diffusion Probabilistic Models (DDPM) <a>[Ho et al. 2020]</a> add Noise
											progressively to the data over discrete time steps.
											<br>
											Let's derive the variance exxploding and perserving continuous-time stochastic differential equations (SDEs) for the noise perturbations from the discrete expressions.								
										</p>
										<h4>2.1.1. Variance Exploding Stochastic Differential Equation (VE-SDE)</h4>
										<p>
											<b>Variance Exploding (VE)</b> is used in SMLD and it constists of progressively increasing the variance of the noise over time.
											This paper leverages VE-SDE to create robust denoising trajectories and stable training.
											But how is this done?
											We will define two equations of the stochastic process with standard deviation \( \sigma \) and variance \( \beta \) of the noise distribution.
											This will allow us to control the noise scale over time with variance exploding or variance preserving noise.
											<br>
											First, let's consider a Markov chain of \( N \) steps, each of them containing a noise scale with perturbation kernels \( p_{\sigma_i}(\mathbf{x} \vert \mathbf{x}_o) \) or, in other words, the probability distributions of the noisy observations \( \mathbf{x} \) given the data point \( \mathbf{x}_0 \),
											where \( i \) is the time step index. The state at the \( i \)-th time step is given by the Markov chain:
											\[
												\mathbf{x}_i = \mathbf{x}_{i-1} + \sqrt{\sigma_i^2 - \sigma_{i-1}^2} \ \mathbf{z}_{i-1}, \quad i=1, \cdots, N
												\tag{Eq. 1} \label{eq:markov_chain_ve}
											\]

											where:
											<ul>
												<li>\( \mathbf{z}_{i-1} \sim \mathcal{N}(\mathbf{0, I}) \) is a standard Gaussian noise.</li>
												<li>\( \sigma_0 = 0 \) because it is the noise level or perturbation at the beginning of the process.</li> 
												<li>\( \mathbf{x}_0 \sim p_{data} \) is the dataset distribution.</li>
											</ul>
											If we have infinite time steps, \( N \rightarrow \infty \), the Markov chain \( \) .
											Let's define an infinitesimal continuous time step \( \Delta t\) and rewrite rewrite <a>Eq. 1</a> as:
											\[
											\mathbf{x}(t + \Delta t) = \mathbf{x}(t) + \sqrt{\sigma^2(t + \Delta t) - \sigma^2(t)} \, \mathbf{z}(t) 
											\overset{\text{1st-order Taylor expansion}}{\approx} \mathbf{x}(t) + \sqrt{\frac{\text{d} [\sigma^2(t)]}{\text{d}t}} \Delta t \, \mathbf{z}(t),
												\tag{Eq. 2} \label{eq:continuous_time}
											\]
											Note that we approximate the continuous incremental standard deviation of the noise \( \sqrt{\sigma^2(t + \Delta t) - \sigma^2(t)} \) to the term \( \sqrt{\frac{\text{d} [\sigma^2(t)]}{\text{d}t}} \text{d}\mathbf{w} \) with the 1st-order Taylor expansion which assumes a small \( \Delta t \).
											The variable \( \mathbf{w} \) determines the random fluctations of the noise scale over time, which is also called the <b>Wiener process</b> or <b>Brownian motion</b>.
											<a>Eq. 2</a> is the <b>Variance Exploding Stochastic Differential Equation (VE-SDE)</b>. The naming of VE-SDE comes from the fact that the variance of the noise increases over time, growing undboundly.
									</p>
									<h4>2.1.2. Variance Preserving Stochastic Differential Equation (VP-SDE)</h4>
									<p>
										<b>Variance Preserving (VP)</b> is used in DDPM and it constists of keeping the variance of the noise constant over time.
										For VE-SDE, we define \( \sigma \) as the standard deviatiaon of the noise distribution. In a stochastic process, we can also define \( \beta \) as the variance scale of the noise.
										In VP-SDE, the Markov chain for the perturbation kernels \( {p_{\alpha_i} ( \mathbf{x} \vert \mathbf{x}_0)}_{i=1}^N \) where \( \alpha = 1 - \beta \), can be written as:
										\[
											\mathbf{x}_i = \sqrt{1-\beta_i} \ \mathbf{x}_{i-1} + \sqrt{\beta_i} \ \mathbf{z}_{i-1}, \quad i=1, \cdots, N 
											\tag{Eq. 3} \label{eq:markov_chain_vp}
											\]
										<a>Eq. 3</a> is the same as <a>Eq. 1</a> but written in terms of the variance scale \( \beta \) of the noise distribution.
										As we did with VE-SDE, we would like to obtain the continuous time equation for VP-SDE. 
										First, let's again consider a Markov chain of \( N \) steps \( N \rightarrow \infty \). In the case of variance, we define a set of auxiliary noise scales \( \{ \hat{\beta}_i = N \beta_{i=1}^N \} \) to prevent variance from exploding.
										We can rewrite <a>Eq. 3</a> as:
										\[
											\mathbf{x}_i = \sqrt{1-\frac{\hat{\beta}_i}{N}} \ \mathbf{x}_{i-1} + \sqrt{\frac{\hat{\beta}_i}{N}} \ \mathbf{z}_{i-1}, \quad i=1, \cdots, N 
											\tag{Eq. 4} \label{eq:markov_chain_vp_aux}
										\]
										In ...
										We can rewrite <a>Eq. 4</a> as:
										\[
										\begin{align}
										\mathbf{x}(t + \Delta t) &= \sqrt{1 - \beta(t + \Delta t) \Delta t} \ \mathbf{x}(t) + \sqrt{\beta(t + \Delta t) \Delta t} \ \mathbf{z}(t) \tag{Eq. 5.1}\\
										&\overset{\text{1st-order Taylor expansion}}{\approx} \mathbf{x}(t) - \frac{1}{2} \beta(t + \Delta t) \Delta t \mathbf{x}(t) + \sqrt{\beta(t + \Delta t) \Delta t} \ \mathbf{z}(t) \tag{Eq. 5.2}\\
										&\overset{\text{if} \Delta t \text{ is small} \rightarrow \beta(t+\Delta t) \approx \beta(t)}{\approx} \mathbf{x}(t) - \frac{1}{2} \beta(t) \Delta t \ \mathbf{x}(t) + \sqrt{\beta(t) \Delta t} \ \mathbf{z}(t)
										\tag{Eq. 5.3} \label{eq:continuous_time_vp}
										\end{align}
										\]
										where \( \sqrt{\beta(t) \Delta t} \ \mathbf{z}(t) \) is the noise level at time \( t \).
										<br>
										The limit when \( \Delta t \rightarrow 0 \) of Eq. 5.3 is the <b>Variance Preserving Stochastic Differential Equation (VP-SDE)</b> expressed as:
										\[
											\text{d} \mathbf{x} = -\frac{1}{2} \beta(t) \mathbf{x} \text{d}t + \sqrt{\beta(t)} \text{d} \mathbf{w}(t)
											\tag{Eq. 6} \label{eq:vp_sde}
										\]
									</p>
									<p>

									</p>
									<table border="1" style="border-collapse: collapse; width: 100%;">
										<thead>
											<tr>
												<th style="padding: 8px; text-align: left;"></th>
												<th style="padding: 8px; text-align: left;">VE-SDE</th>
												<th style="padding: 8px; text-align: left;">VP-SDE</th>
											</tr>
										</thead>
										<tbody>
											<tr>
												<td style="padding: 8px;">Discrete SDE</td>
												<td style="padding: 8px;">\(\mathbf{x}_i = \mathbf{x}_{i-1} + \sqrt{\sigma_i^2 - \sigma_{i-1}^2} \ \mathbf{z}_{i-1}\)</td>
												<td style="padding: 8px;">\(\mathbf{x}_i = \sqrt{1 - \hat{\beta}_i} \ \mathbf{x}_{i-1} + \sqrt{\hat{\beta}_i} \ \mathbf{z}_{i-1}\)</td>
											</tr>
											<tr>
												<td style="padding: 8px;">Continuous SDE</td>
												<td style="padding: 8px;">\( \mathbf{x}(t + \Delta t) = \mathbf{x}(t) + \sqrt{\sigma^2(t + \Delta t) - \sigma^2(t)} \ \mathbf{z}(t) \)</td>
												<td style="padding: 8px;">\( \mathbf{x}(t + \Delta t) = \mathbf{x}(t) - \frac{1}{2} \beta(t) \Delta t \ \mathbf{x}(t) + \sqrt{\beta(t) \ \Delta t} \ \mathbf{z}(t) \)</td>
											</tr>
											<tr>
												<td style="padding: 8px;">dx</td>
												<td style="padding: 8px;">\( \text{d} \mathbf{x} = \sqrt{\frac{\text{d} [\sigma^2(t)]}{\text{d}t}} \text{d}\mathbf{w} \)</td>
												<td style="padding: 8px;">\( \text{d} \mathbf{x} = -\frac{1}{2} \beta(t) \mathbf{x} \text{d}t + \sqrt{\beta(t)} \text{d} \mathbf{w}(t) \)</td>
											</tr>
										</tbody>
									</table>

                                </div>
                            </div>
							<div class="row">
                                <div class="col-md-12">
                                    <div class="article animate-box">
                                        <h2 id="sampling">
                                            <a href="#table-of-contents" style="text-decoration: none; color: inherit;">3. Sampling</a>
                                        </h2>
										<p>

										</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    


        <div class="row">
            <div class="col-md-12 text-center">
                <p>
                    &copy;
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | Carlos Hern&aacute;ndez Oliv&aacute;n | <a href="https://colorlib.com" target="_blank">Colorlib</a>
                </p>
            </div>
        </div>
    </div>
</div>
</footer>

</div>

<!-- jQuery -->
<script src="../js/jquery.min.js"></script>
<!-- jQuery Easing -->
<script src="../js/jquery.easing.1.3.js"></script>
<!-- Bootstrap -->
<script src="../js/bootstrap.min.js"></script>
<!-- Waypoints -->
<script src="../js/jquery.waypoints.min.js"></script>
<!-- Owl Carousel -->
<script src="../js/owl.carousel.min.js"></script>
<!-- Magnific Popup -->
<script src="../js/jquery.magnific-popup.min.js"></script>
<script src="../js/magnific-popup-options.js"></script>

<!-- Main JS (Do not remove) -->
<script src="../js/main.js"></script>

</body>
</html>